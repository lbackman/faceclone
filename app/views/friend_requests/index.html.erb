<h1>Friend Requests</h1>
<%= form_with url: user_friend_requests_path(Current.user),
              method: :get,
              class: "search-form d-flex mb-2",
              data: {
                turbo_frame: "friend_requests",
                controller: "form",
                form_timeout_value: 0,
                action: "click->form#submit" } do |form| %>
  <div class="btn-group" role="group" aria-label="friend-request-direction">
    <%= form.radio_button :direction, "received", checked: true, class: "btn-check", autocomplete: "off" %>
    <%= form.label :direction_received, "Received", class: "btn btn-outline-primary", style:"width: 100px;" %>
    <%= form.radio_button :direction, "sent", class: "btn-check", autocomplete: "off" %>
    <%= form.label :direction_sent, "Sent", class: "btn btn-outline-primary", style:"width: 100px;" %>
  </div>
  <%= form.submit "Search", class: "ms-2 btn btn-outline-primary btn-sm visually-hidden" %>
<% end %>

<%= turbo_frame_tag "friend_requests" do %>
  <% @friend_requests.each do |friend_request| %>
    <% if Current.user == friend_request.receiver %>
      <% sender = friend_request.sender %>
      <%= render 'users/user_with_avatar', user: sender, avatar_resolution: 100, options: {data: { turbo_frame: "_top" }} %>
      <%= render 'users/friend_buttons', user: Current.user, other_user: sender, friend_request: %>
    <% else %>
      <% receiver = friend_request.receiver %>
      <%= render 'users/user_with_avatar', user: receiver, avatar_resolution: 100, options: {data: { turbo_frame: "_top" }} %>
      <%= render 'users/friend_buttons', user: Current.user, other_user: receiver, friend_request: %>
    <% end %>
  <% end %>
<% end %>
